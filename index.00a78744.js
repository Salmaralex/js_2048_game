const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.emptyfields=[],this.status="idle",this.score=0,this.rows=document.querySelectorAll(".field-row"),this.setEmptyfields()}isWin(){return this.initialState.some(t=>t.some(t=>2048===t))}isGameOver(){if(this.emptyfields.length>0)return!1;for(let t=0;t<this.initialState.length;t++)for(let e=0;e<this.initialState[t].length;e++){let i=this.initialState[t][e];if(e<this.initialState[t].length-1&&i===this.initialState[t][e+1]||t<this.initialState.length-1&&i===this.initialState[t+1][e])return!1}return!0}stateChanged(t){return this.initialState.some((e,i)=>e.some((e,s)=>e!==t[i][s]))}moveLeft(){this.initialState.forEach((t,e)=>{this.initialState[e]=this.merge(t)})}moveRight(){this.initialState.forEach((t,e)=>{let i=this.merge(t.reverse());this.initialState[e]=i.reverse()})}moveUp(){this.initialState=this.transpose(this.initialState),this.initialState.forEach((t,e)=>{let i=this.merge(t);this.initialState[e]=i}),this.initialState=this.transpose(this.initialState)}moveDown(){this.initialState=this.transpose(this.initialState),this.initialState.forEach((t,e)=>{let i=this.merge(t.reverse());this.initialState[e]=i.reverse()}),this.initialState=this.transpose(this.initialState)}getScore(){return this.score}getState(){}getStatus(){}start(){"idle"===this.status&&(this.status="playing",this.createPlate(),this.createPlate())}setEmptyfields(){this.emptyfields=[];for(let t=0;t<this.initialState.length;t++)for(let e=0;e<this.initialState[t].length;e++)0===this.initialState[t][e]&&this.emptyfields.push({row:t,col:e})}setRandomField(){if(0===this.emptyfields.length)return null;let t=Math.floor(Math.random()*this.emptyfields.length),e=this.emptyfields[t];return this.initialState[e.row][e.col]=.1>Math.random()?4:2,this.emptyfields.splice(t,1),e}createTeableArray(){return this.initialState.map(t=>t.map(t=>({content:t,classes:t>0?[`field-cell--${t}`]:[]})))}transpose(t){return t[0].map((e,i)=>t.map(t=>t[i]))}merge(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t],t++);let i=e.filter(t=>0!==t);return[...i,...Array(4-i.length).fill(0)]}createPlate(){let t=this.createTeableArray();this.updateTable(t);let e=this.setRandomField();null!==e&&(t[e.row][e.col].content=this.initialState[e.row][e.col],t[e.row][e.col].classes.push(`field-cell--${t[e.row][e.col].content}`),this.updateTable(t))}updateTable(t){this.rows.forEach((e,i)=>{Array.from(e.children).forEach((e,s)=>{let a=t[i][s];0!==a.content?(e.textContent=a.content,e.classList=["field-cell"],e.classList.add(a.classes)):(e.textContent="",e.classList=["field-cell"])})}),this.setEmptyfields()}restart(){this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.emptyfields=[],this.status="idle",this.score=0,this.setEmptyfields();let t=this.createTeableArray();this.updateTable(t),this.score=0}},e=document.getElementsByClassName("button start")[0],i=document.getElementsByClassName("game-score")[0],s=document.getElementsByClassName("controls")[0],a=document.getElementsByClassName("message message-start")[0],l=document.getElementsByClassName("message message-win hidden")[0],n=document.getElementsByClassName("message message-lose hidden")[0],r=document.createElement("button");function h(e){let s=t.initialState.map(t=>[...t]);switch(e.code){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}t.stateChanged(s)&&t.createPlate(),i.textContent=t.getScore(),o()}function o(){if(t.isWin()){t.status="win",l.classList.remove("hidden"),document.removeEventListener("keydown",h);return}t.isGameOver()&&(t.status="lose",n.classList.remove("hidden"),document.removeEventListener("keydown",h))}r.className="button restart",r.style.display="none",r.innerText="Restart",s.appendChild(r),e.addEventListener("click",()=>{t.start(),t.status="playing",document.addEventListener("keydown",h),o(),e.style.display="none",r.style.display="",a.classList.add("hidden")}),r.addEventListener("click",()=>{t.restart(),t.status="idle",e.style.display="",r.style.display="none",i.innerText=t.getScore(),l.classList.add("hidden"),n.classList.add("hidden")});
//# sourceMappingURL=index.00a78744.js.map
